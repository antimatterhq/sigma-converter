{
  "metadata": {
    "name": "Sysinternals Tools AppX Versions Execution",
    "comment": "Detects execution of Sysinternals tools via an AppX package. Attackers could install the Sysinternals Suite to get access to tools such as psexec and procdump to avoid detection based on System paths",
    "annotations": {
      "source": "sigma",
      "product": "windows",
      "service": "appmodel-runtime",
      "sigma_status": "test"
    }
  },
  "spec": {
    "schedule": {
      "atLeastEvery": "12h",
      "enabled": false
    },
    "input": {
      "batch": {
        "sql": "SELECT * FROM process_activity WHERE time BETWEEN CURRENT_TIMESTAMP() - INTERVAL 24 HOUR AND CURRENT_TIMESTAMP() AND (metadata.event_code = 201 AND (lower(LOWER(process.name)) in ('procdump\\.exe', 'psloglist\\.exe', 'psexec\\.exe', 'livekd\\.exe', 'adexplorer\\.exe')))"
      }
    },
    "output": {
      "summary": "Detects execution of Sysinternals tools via an AppX package. Attackers could install the Sysinternals Suite to get access to tools such as psexec and procdump to avoid detection based on System paths",
      "defaultContext": true
    },
    "metadata": {
      "version": 1.0,
      "severity": "Low",
      "fidelity": "Investigative",
      "objective": "False positive: Legitimate usage of the applications from the Windows Store Reference: Internal Research",
      "mitre": [
        {
          "taxonomy": "MITRE ATT&CK",
          "tactic": "Defense-Evasion"
        },
        {
          "taxonomy": "MITRE ATT&CK",
          "tactic": "Execution"
        }
      ]
    },
    "computeMode": "high"
  },
  "apiVersion": "v1",
  "kind": "Rule"
}