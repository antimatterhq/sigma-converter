{
  "metadata": {
    "name": "AWS EFS Fileshare Mount Modified or Deleted",
    "comment": "Detects when a EFS Fileshare Mount is modified or deleted. An adversary breaking any file system using the mount target that is being deleted, which might disrupt instances or applications using those mounts.",
    "annotations": {
      "source": "sigma",
      "product": "aws",
      "service": "cloudtrail",
      "sigma_status": "test"
    }
  },
  "spec": {
    "schedule": {
      "atLeastEvery": "12h",
      "enabled": false
    },
    "input": {
      "batch": {
        "sql": "SELECT * FROM file_activity WHERE time BETWEEN CURRENT_TIMESTAMP() - INTERVAL 24 HOUR AND CURRENT_TIMESTAMP() AND (activity_id = 13 AND lower(metadata.product.name) = lower('elasticfilesystem.amazonaws.com') AND lower(metadata.event_code) = lower('deletemounttarget'))"
      }
    },
    "output": {
      "summary": "Detects when a EFS Fileshare Mount is modified or deleted. An adversary breaking any file system using the mount target that is being deleted, which might disrupt instances or applications using those mounts.",
      "defaultContext": true
    },
    "metadata": {
      "version": 1.0,
      "severity": "Medium",
      "fidelity": "Investigative",
      "objective": "False positive: Unknown Reference: https://docs.aws.amazon.com/efs/latest/ug/API_DeleteMountTarget.html",
      "mitre": [
        {
          "taxonomy": "MITRE ATT&CK",
          "tactic": "Impact",
          "techniqueId": "T1485"
        }
      ]
    },
    "computeMode": "high"
  },
  "apiVersion": "v1",
  "kind": "Rule"
}