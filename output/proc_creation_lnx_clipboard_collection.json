{
  "metadata": {
    "name": "Clipboard Collection with Xclip Tool",
    "comment": "Detects attempts to collect data stored in the clipboard from users with the usage of xclip tool. Xclip has to be installed. Highly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.",
    "annotations": {
      "source": "sigma",
      "category": "process_creation",
      "product": "linux",
      "sigma_status": "test"
    }
  },
  "spec": {
    "schedule": {
      "atLeastEvery": "15m",
      "enabled": true
    },
    "input": {
      "batch": {
        "sql": "SELECT * FROM process_activity WHERE time BETWEEN CURRENT_TIMESTAMP() - INTERVAL 24 HOUR AND CURRENT_TIMESTAMP() AND (lower(activity_id) = lower('1') AND contains(lower(process.name), lower('xclip')) AND contains(lower(process.cmd_line), lower('-sel')) AND contains(lower(process.cmd_line), lower('clip')) AND contains(lower(process.cmd_line), lower('-o')))"
      }
    },
    "output": {
      "summary": "Detects attempts to collect data stored in the clipboard from users with the usage of xclip tool. Xclip has to be installed. Highly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.",
      "defaultContext": true
    },
    "metadata": {
      "version": 1.0,
      "severity": "Low",
      "fidelity": "Investigative",
      "objective": "False positive: Legitimate usage of xclip tools. Reference: https://www.packetlabs.net/posts/clipboard-data-security/",
      "mitre": [
        {
          "taxonomy": "MITRE ATT&CK",
          "tactic": "Collection",
          "techniqueId": "T1115"
        }
      ]
    },
    "computeMode": "high"
  },
  "apiVersion": "v1",
  "kind": "Rule"
}