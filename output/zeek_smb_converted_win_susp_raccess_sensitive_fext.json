{
  "metadata": {
    "name": "Suspicious Access to Sensitive File Extensions - Zeek",
    "comment": "Detects known sensitive file extensions via Zeek",
    "annotations": {
      "source": "sigma",
      "product": "zeek",
      "service": "smb_files",
      "sigma_status": "test"
    }
  },
  "spec": {
    "schedule": {
      "atLeastEvery": "12h",
      "enabled": false
    },
    "input": {
      "batch": {
        "sql": "SELECT * FROM file_activity WHERE time BETWEEN CURRENT_TIMESTAMP() - INTERVAL 24 HOUR AND CURRENT_TIMESTAMP() AND (endswith(lower(file.name), lower('.pst')) OR endswith(lower(file.name), lower('.ost')) OR endswith(lower(file.name), lower('.msg')) OR endswith(lower(file.name), lower('.nst')) OR endswith(lower(file.name), lower('.oab')) OR endswith(lower(file.name), lower('.edb')) OR endswith(lower(file.name), lower('.nsf')) OR endswith(lower(file.name), lower('.bak')) OR endswith(lower(file.name), lower('.dmp')) OR endswith(lower(file.name), lower('.kirbi')) OR endswith(lower(file.name), lower('\\\\groups.xml')) OR endswith(lower(file.name), lower('.rdp')))"
      }
    },
    "output": {
      "summary": "Detects known sensitive file extensions via Zeek",
      "defaultContext": true
    },
    "metadata": {
      "version": 1.0,
      "severity": "Medium",
      "fidelity": "Investigative",
      "objective": "False positives: 1. Help Desk operator doing backup or re-imaging end user machine or backup software 2. Users working with these data types or exchanging message files Reference: Internal Research",
      "mitre": [
        {
          "taxonomy": "MITRE ATT&CK",
          "tactic": "Collection"
        }
      ]
    },
    "computeMode": "high"
  },
  "apiVersion": "v1",
  "kind": "Rule"
}