{
  "metadata": {
    "name": "JAMF MDM Execution",
    "comment": "Detects execution of the \"jamf\" binary to create user accounts and run commands. For example, the binary can be abused by attackers on the system in order to bypass security controls or remove application control polices.",
    "annotations": {
      "source": "sigma",
      "category": "process_creation",
      "product": "macos",
      "sigma_status": "test"
    }
  },
  "spec": {
    "schedule": {
      "atLeastEvery": "15m",
      "enabled": true
    },
    "input": {
      "batch": {
        "sql": "SELECT * FROM process_activity WHERE time BETWEEN CURRENT_TIMESTAMP() - INTERVAL 24 HOUR AND CURRENT_TIMESTAMP() AND (lower(activity_id) = lower('1') AND endswith(lower(process.name), lower('/jamf')) AND (contains(lower(process.cmd_line), lower('createaccount')) OR contains(lower(process.cmd_line), lower('manage')) OR contains(lower(process.cmd_line), lower('removeframework')) OR contains(lower(process.cmd_line), lower('removemdmprofile')) OR contains(lower(process.cmd_line), lower('resetpassword')) OR contains(lower(process.cmd_line), lower('setcomputername'))))"
      }
    },
    "output": {
      "summary": "Detects execution of the \"jamf\" binary to create user accounts and run commands. For example, the binary can be abused by attackers on the system in order to bypass security controls or remove application control polices.",
      "defaultContext": true
    },
    "metadata": {
      "version": 1.0,
      "severity": "Low",
      "fidelity": "Investigative",
      "objective": "False positive: Legitimate use of the JAMF CLI tool by IT support and administrators References: https://github.com/MythicAgents/typhon/, https://www.zoocoup.org/casper/jamf_cheatsheet.pdf, https://docs.jamf.com/10.30.0/jamf-pro/administrator-guide/Components_Installed_on_Managed_Computers.html",
      "mitre": [
        {
          "taxonomy": "MITRE ATT&CK",
          "tactic": "Execution"
        }
      ]
    },
    "computeMode": "high"
  },
  "apiVersion": "v1",
  "kind": "Rule"
}