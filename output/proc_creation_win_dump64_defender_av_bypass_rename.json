{
  "metadata": {
    "name": "Potential Windows Defender AV Bypass Via Dump64.EXE Rename",
    "comment": "Detects when a user is potentially trying to bypass the Windows Defender AV by renaming a tool to dump64.exe and placing it in the Visual Studio folder. Currently the rule is covering only usage of procdump but other utilities can be added in order to increase coverage.",
    "annotations": {
      "source": "sigma",
      "category": "process_creation",
      "product": "windows",
      "sigma_status": "test"
    }
  },
  "spec": {
    "schedule": {
      "atLeastEvery": "12h",
      "enabled": false
    },
    "input": {
      "batch": {
        "sql": "SELECT * FROM process_activity WHERE time BETWEEN CURRENT_TIMESTAMP() - INTERVAL 24 HOUR AND CURRENT_TIMESTAMP() AND (activity_id = 1 AND startswith(lower(process.name), lower(':\\\\\\\\program files')) AND contains(lower(process.name), lower('\\\\\\\\microsoft visual studio\\\\\\\\')) AND endswith(lower(process.name), lower('\\\\\\\\dump64.exe')) AND lower(process.file.name) = lower('procdump') AND (contains(lower(process.cmd_line), lower(' -ma ')) OR contains(lower(process.cmd_line), lower(' -mp '))))"
      }
    },
    "output": {
      "summary": "Detects when a user is potentially trying to bypass the Windows Defender AV by renaming a tool to dump64.exe and placing it in the Visual Studio folder. Currently the rule is covering only usage of procdump but other utilities can be added in order to increase coverage.",
      "defaultContext": true
    },
    "metadata": {
      "version": 1.0,
      "severity": "High",
      "fidelity": "Investigative",
      "objective": "False positive: Unknown Reference: https://twitter.com/mrd0x/status/1460597833917251595",
      "mitre": [
        {
          "taxonomy": "MITRE ATT&CK",
          "tactic": "Credential-Access",
          "techniqueId": "T1003",
          "subTechniqueId": "001"
        }
      ]
    },
    "computeMode": "high"
  },
  "apiVersion": "v1",
  "kind": "Rule"
}