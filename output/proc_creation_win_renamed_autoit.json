{
  "metadata": {
    "name": "Renamed AutoIt Execution",
    "comment": "Detects the execution of a renamed AutoIt2.exe or AutoIt3.exe. AutoIt is a scripting language and automation tool for Windows systems. While primarily used for legitimate automation tasks, it can be misused in cyber attacks. Attackers can leverage AutoIt to create and distribute malware, including keyloggers, spyware, and botnets. A renamed AutoIt executable is particularly suspicious.",
    "annotations": {
      "source": "sigma",
      "category": "process_creation",
      "product": "windows",
      "sigma_status": "test"
    }
  },
  "spec": {
    "schedule": {
      "atLeastEvery": "15m",
      "enabled": true
    },
    "input": {
      "batch": {
        "sql": "SELECT * FROM process_activity WHERE time BETWEEN CURRENT_TIMESTAMP() - INTERVAL 24 HOUR AND CURRENT_TIMESTAMP() AND (lower(activity_id) = lower('1') AND (contains(lower(process.cmd_line), lower(' /autoit3executescript')) OR contains(lower(process.cmd_line), lower(' /errorstdout')) OR contains(lower(process.file.hashes.value), lower('imphash=fdc554b3a8683918d731685855683ddf')) OR contains(lower(process.file.hashes.value), lower('imphash=cd30a61b60b3d60cecdb034c8c83c290')) OR contains(lower(process.file.hashes.value), lower('imphash=f8a00c72f2d667d2edbb234d0c0ae000')) OR lower(LOWER(process.file.name)) in ('autoit3\\.exe', 'autoit2\\.exe', 'autoit\\.exe')) AND NOT (endswith(lower(process.name), lower('\\\\autoit.exe')) OR endswith(lower(process.name), lower('\\\\autoit2.exe')) OR endswith(lower(process.name), lower('\\\\autoit3_x64.exe')) OR endswith(lower(process.name), lower('\\\\autoit3.exe'))))"
      }
    },
    "output": {
      "summary": "Detects the execution of a renamed AutoIt2.exe or AutoIt3.exe. AutoIt is a scripting language and automation tool for Windows systems. While primarily used for legitimate automation tasks, it can be misused in cyber attacks. Attackers can leverage AutoIt to create and distribute malware, including keyloggers, spyware, and botnets. A renamed AutoIt executable is particularly suspicious.",
      "defaultContext": true
    },
    "metadata": {
      "version": 1.0,
      "severity": "High",
      "fidelity": "Investigative",
      "objective": "False positive: Unknown References: https://twitter.com/malmoeb/status/1665463817130725378?s=12&t=C0_T_re0wRP_NfKa27Xw9w, https://www.autoitscript.com/site/",
      "mitre": [
        {
          "taxonomy": "MITRE ATT&CK",
          "tactic": "Defense-Evasion",
          "techniqueId": "T1027"
        }
      ]
    },
    "computeMode": "high"
  },
  "apiVersion": "v1",
  "kind": "Rule"
}