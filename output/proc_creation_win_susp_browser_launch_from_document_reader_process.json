{
  "metadata": {
    "name": "Potential Suspicious Browser Launch From Document Reader Process",
    "comment": "Detects when a browser process or browser tab is launched from an application that handles document files such as Adobe, Microsoft Office, etc. And connects to a web application over http(s), this could indicate a possible phishing attempt.",
    "annotations": {
      "source": "sigma",
      "category": "process_creation",
      "product": "windows",
      "sigma_status": "experimental"
    }
  },
  "spec": {
    "schedule": {
      "atLeastEvery": "15m",
      "enabled": true
    },
    "input": {
      "batch": {
        "sql": "SELECT * FROM process_activity WHERE time BETWEEN CURRENT_TIMESTAMP() - INTERVAL 24 HOUR AND CURRENT_TIMESTAMP() AND (lower(activity_id) = lower('1') AND (contains(lower(process.parent_process.name), lower('acrobat reader')) OR contains(lower(process.parent_process.name), lower('microsoft office')) OR contains(lower(process.parent_process.name), lower('pdf reader'))) AND (endswith(lower(process.name), lower('\\\\brave.exe')) OR endswith(lower(process.name), lower('\\\\chrome.exe')) OR endswith(lower(process.name), lower('\\\\firefox.exe')) OR endswith(lower(process.name), lower('\\\\msedge.exe')) OR endswith(lower(process.name), lower('\\\\opera.exe')) OR endswith(lower(process.name), lower('\\\\maxthon.exe')) OR endswith(lower(process.name), lower('\\\\seamonkey.exe')) OR endswith(lower(process.name), lower('\\\\vivaldi.exe')) OR startswith(lower(process.name), lower(''))) AND contains(lower(process.cmd_line), lower('http')))"
      }
    },
    "output": {
      "summary": "Detects when a browser process or browser tab is launched from an application that handles document files such as Adobe, Microsoft Office, etc. And connects to a web application over http(s), this could indicate a possible phishing attempt.",
      "defaultContext": true
    },
    "metadata": {
      "version": 1.0,
      "severity": "Medium",
      "fidelity": "Investigative",
      "objective": "False positive: Unlikely in most cases, further investigation should be done in the commandline of the browser process to determine the context of the URL accessed. References: https://app.any.run/tasks/69c5abaa-92ad-45ba-8c53-c11e23e05d04/, https://app.any.run/tasks/64043a79-165f-4052-bcba-e6e49f847ec1/",
      "mitre": [
        {
          "taxonomy": "MITRE ATT&CK",
          "tactic": "Execution",
          "techniqueId": "T1204",
          "subTechniqueId": "002"
        }
      ]
    },
    "computeMode": "high"
  },
  "apiVersion": "v1",
  "kind": "Rule"
}