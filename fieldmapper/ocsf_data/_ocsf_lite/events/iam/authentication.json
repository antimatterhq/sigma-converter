{
  "uid": 2,
  "caption": "Authentication",
  "description": "Authentication events report authentication session activities, including user attempts to log on or log off, regardless of success, as well as other key stages within the authentication process. These events are typically generated by authentication services, such as Kerberos, OIDC, or SAML, and may include information about the user, the authentication method used, and the status of the authentication attempt.",
  "extends": "base_event",
  "name": "authentication",
  "associations": {
    "actor.user": [
      "src_endpoint"
    ],
    "dst_endpoint": [
      "user"
    ],
    "src_endpoint": [
      "actor.user"
    ],
    "user": [
      "dst_endpoint"
    ]
  },
  "attributes": {
    "activity": {
      "description": "The normalized caption of 'activity_id' or the source specific value.",
      "requirement": "optional"
    },
    "activity_id": {
      "enum": {
        "0": {
          "caption": "Unknown",
          "description": "Unknown"
        },
        "1": {
          "caption": "Logon",
          "description": "A new logon session was requested."
        },
        "2": {
          "caption": "Logoff",
          "description": "A logon session was terminated and no longer exists."
        },
        "3": {
          "caption": "Authentication Ticket",
          "description": "A Kerberos authentication ticket (TGT) was requested."
        },
        "4": {
          "caption": "Service Ticket Request",
          "description": "A Kerberos service ticket was requested."
        },
        "5": {
          "caption": "Service Ticket Renew",
          "description": "A Kerberos service ticket was renewed."
        },
        "6": {
          "caption": "Preauth",
          "description": "A preauthentication stage was engaged."
        },
        "99": {
          "caption": "Other",
          "description": "Not mapped"
        }
      }
    },
    "actor": {
      "group": "context",
      "requirement": "required",
      "object": "actor",
      "constraints": {
        "at_least_one": [
          "process",
          "user",
          "invoked_by",
          "session",
          "app_name",
          "app_uid"
        ]
      }
    },
    "auth_factors": {
      "group": "context",
      "requirement": "optional"
    },
    "auth_protocol": {
      "group": "primary",
      "requirement": "recommended"
    },
    "auth_protocol_id": {
      "group": "primary",
      "requirement": "recommended",
      "enum": {
        "0": {
          "caption": "Unknown",
          "description": "The authentication protocol is unknown."
        },
        "1": {
          "caption": "NTLM",
          "description": "NTLM is a network authentication protocol that uses cryptographic keys to authenticate users and services."
        },
        "2": {
          "caption": "Kerberos",
          "description": "Kerberos is a network authentication protocol that uses cryptographic keys to authenticate users and services."
        },
        "3": {
          "caption": "Digest",
          "description": "Digest is a network authentication protocol that uses cryptographic keys to authenticate users and services."
        },
        "4": {
          "caption": "OpenID",
          "description": "OpenID is an open standard for authentication that allows users to authenticate with a third-party identity provider."
        },
        "5": {
          "caption": "SAML",
          "description": "Security Assertion Markup Language is an open standard for authentication that allows users to authenticate with a third-party identity provider."
        },
        "6": {
          "caption": "OAuth2.0",
          "description": "OAuth2 is an open standard for authentication that allows users to authenticate with a third-party identity provider."
        },
        "7": {
          "caption": "PAP",
          "description": "PAP is a network authentication protocol that uses cryptographic keys to authenticate users and services."
        },
        "8": {
          "caption": "CHAP",
          "description": "CHAP is a network authentication protocol that uses cryptographic keys to authenticate users and services."
        },
        "9": {
          "caption": "EAP",
          "description": "EAP is a network authentication protocol that uses cryptographic keys to authenticate users and services."
        },
        "10": {
          "caption": "RADIUS",
          "description": "RADIUS is a network authentication protocol that uses cryptographic keys to authenticate users and services."
        },
        "11": {
          "caption": "Basic Authentication",
          "description": "Basic Authentication is a network authentication protocol that uses cryptographic keys to authenticate users and services."
        },
        "12": {
          "caption": "LDAP",
          "description": "LDAP is a network authentication protocol that uses cryptographic keys to authenticate users and services."
        },
        "99": {
          "caption": "Other",
          "description": "The authentication protocol is not mapped."
        }
      }
    },
    "class_uid": {
      "description": "The class of the event.",
      "group": "primary",
      "requirement": "required",
      "enum": {
        "3002": {
          "caption": "Authentication"
        }
      }
    },
    "cloud": {
      "caption": "Cloud",
      "description": "The Cloud object contains information about a cloud or Software-as-a-Service account or similar construct, such as AWS Account ID, regions, organizations, folders, compartments, tenants, etc.",
      "object": "cloud"
    },
    "dst_endpoint": {
      "description": "The endpoint to which the authentication was targeted.",
      "group": "primary",
      "requirement": "recommended",
      "object": "network endpoint",
      "constraints": {
        "at_least_one": [
          "domain",
          "hostname",
          "instance_uid",
          "interface_name",
          "interface_uid",
          "ip",
          "name",
          "svc_name",
          "uid"
        ]
      }
    },
    "is_mfa": {
      "group": "primary",
      "requirement": "recommended"
    },
    "is_remote": {
      "description": "The attempted authentication is over a remote connection.",
      "group": "primary",
      "requirement": "recommended"
    },
    "logon_type": {
      "group": "primary",
      "requirement": "recommended"
    },
    "logon_type_id": {
      "group": "primary",
      "requirement": "recommended",
      "enum": {
        "0": {
          "caption": "Unknown",
          "description": "The logon type is unknown."
        },
        "1": {
          "caption": "System",
          "description": "Used only by the System account, for example at system startup."
        },
        "2": {
          "caption": "Interactive",
          "description": "A local logon to device console."
        },
        "3": {
          "caption": "Network",
          "description": "A user or device logged onto this device from the network."
        },
        "4": {
          "caption": "Batch",
          "description": "A batch server logon, where processes may be executing on behalf of a user without their direct intervention."
        },
        "5": {
          "caption": "OS Service",
          "description": "A logon by a service or daemon that was started by the OS."
        },
        "7": {
          "caption": "Unlock",
          "description": "A user unlocked the device."
        },
        "8": {
          "caption": "Network Cleartext",
          "description": "A user logged on to this device from the network. The user's password in the authentication package was not hashed."
        },
        "9": {
          "caption": "New Credentials",
          "description": "A caller cloned its current token and specified new credentials for outbound connections. The new logon session has the same local identity, but uses different credentials for other network connections."
        },
        "10": {
          "caption": "Remote Interactive",
          "description": "A remote logon using Terminal Services or remote desktop application."
        },
        "11": {
          "caption": "Cached Interactive",
          "description": "A user logged on to this device with network credentials that were stored locally on the device and the domain controller was not contacted to verify the credentials."
        },
        "12": {
          "caption": "Cached Remote Interactive",
          "description": "Same as Remote Interactive. This is used for internal auditing."
        },
        "13": {
          "caption": "Cached Unlock",
          "description": "Workstation logon."
        },
        "99": {
          "caption": "Other",
          "description": "The logon type is not mapped. See the logon_type attribute, which contains a data source specific value."
        }
      }
    },
    "service": {
      "description": "The service or gateway to which the user or process is being authenticated",
      "group": "primary",
      "requirement": "recommended",
      "object": "service",
      "constraints": {
        "at_least_one": [
          "name",
          "uid"
        ]
      }
    },
    "session": {
      "description": "The session that the authentication was attempted on.",
      "group": "primary",
      "requirement": "recommended",
      "object": "session"
    },
    "src_endpoint": {
      "description": "The endpoint from which the network traffic was sent.",
      "group": "primary",
      "requirement": "recommended",
      "object": "network endpoint",
      "constraints": {
        "at_least_one": [
          "domain",
          "hostname",
          "instance_uid",
          "interface_name",
          "interface_uid",
          "ip",
          "name",
          "svc_name",
          "uid"
        ]
      }
    },
    "status_detail": {
      "description": "The details about the authentication request. For example, possible details for Windows logon or logoff events are:<ul><li>Success</li><ul><li>LOGOFF_USER_INITIATED</li><li>LOGOFF_OTHER</li></ul><li>Failure</li><ul><li>USER_DOES_NOT_EXIST</li><li>INVALID_CREDENTIALS</li><li>ACCOUNT_DISABLED</li><li>ACCOUNT_LOCKED_OUT</li><li>PASSWORD_EXPIRED</li></ul></ul>"
    },
    "type_uid": {
      "description": "The type of the authentication event.",
      "group": "primary",
      "requirement": "recommended",
      "enum": {
        "0": {
          "caption": "Unknown",
          "description": "Unknown"
        },
        "300200": {
          "caption": "Unknown",
          "description": "The activity type \"Authentication: Unknown\" is not further specified."
        },
        "300201": {
          "caption": "Logon",
          "description": "A new logon session was requested."
        },
        "300202": {
          "caption": "Logoff",
          "description": "A logon session was terminated and no longer exists."
        },
        "300203": {
          "caption": "Authentication Ticket",
          "description": "A Kerberos authentication ticket (TGT) was requested."
        },
        "300204": {
          "caption": "Service Ticket Request",
          "description": "A Kerberos service ticket was requested."
        },
        "300205": {
          "caption": "Service Ticket Renew",
          "description": "A Kerberos service ticket was renewed."
        },
        "300206": {
          "caption": "Preauth",
          "description": "A preauthentication stage was engaged."
        },
        "300299": {
          "caption": "Other",
          "description": "The activity type \"Authentication: Other\" is not further specified."
        },
        "99": {
          "caption": "Other",
          "description": "Not mapped"
        }
      }
    },
    "user": {
      "description": "The subject (user/role or account) to authenticate.",
      "group": "primary",
      "requirement": "required",
      "object": "user",
      "constraints": {
        "at_least_one": [
          "name",
          "uid",
          "account"
        ]
      }
    }
  },
  "constraints": {
    "at_least_one": [
      "service",
      "dst_endpoint"
    ]
  }
}
