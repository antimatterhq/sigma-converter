{
  "uid": 3,
  "caption": "DNS Activity",
  "description": "DNS Activity events report DNS queries and answers as seen on the network.",
  "extends": "base_event",
  "name": "dns_activity",
  "attributes": {
    "activity": {
      "description": "The normalized caption of 'activity_id' or the source specific value.",
      "requirement": "optional"
    },
    "activity_id": {
      "enum": {
        "0": {
          "caption": "Unknown",
          "description": "Unknown"
        },
        "1": {
          "caption": "Query",
          "description": "The DNS query request."
        },
        "2": {
          "caption": "Response",
          "description": "The DNS query response."
        },
        "6": {
          "caption": "Traffic",
          "description": "Bidirectional DNS request and response traffic."
        },
        "99": {
          "caption": "Other",
          "description": "Not mapped"
        }
      }
    },
    "answers": {
      "group": "primary",
      "requirement": "recommended"
    },
    "app_name": {
      "description": "The name of the application associated with the event or object.",
      "requirement": "optional"
    },
    "category_uid": {
      "description": "The category unique identifier of the event.",
      "requirement": "required",
      "enum": {
        "0": {
          "caption": "Unknown",
          "description": "Unknown"
        },
        "4": {
          "caption": "Network Activity",
          "description": "Network Activity events."
        },
        "99": {
          "caption": "Other",
          "description": "Not mapped"
        }
      }
    },
    "class_uid": {
      "description": "The unique identifier of a class. A class describes the attributes available in an event.",
      "requirement": "required",
      "enum": {
        "0": {
          "caption": "Unknown",
          "description": "Unknown"
        },
        "4003": {
          "caption": "DNS Activity",
          "description": "DNS Activity events report DNS queries and answers as seen on the network."
        },
        "99": {
          "caption": "Other",
          "description": "Not mapped"
        }
      }
    },
    "connection_info": {
      "description": "The connection information relevant to the network traffic.",
      "requirement": "recommended",
      "object": "network connection information"
    },
    "dst_endpoint": {
      "description": "The responder (server) in a network connection.",
      "group": "primary",
      "requirement": "recommended",
      "object": "network endpoint",
      "constraints": {
        "at_least_one": [
          "domain",
          "hostname",
          "instance_uid",
          "interface_name",
          "interface_uid",
          "ip",
          "name",
          "svc_name",
          "uid"
        ]
      }
    },
    "query": {
      "group": "primary",
      "requirement": "recommended",
      "object": "dns query"
    },
    "rcode": {
      "description": "The DNS server response code, normalized to the caption of the rcode_id value. In the case of 'Other', it is defined by the event source.",
      "group": "primary",
      "requirement": "recommended"
    },
    "rcode_id": {
      "caption": "Response Code ID",
      "description": "The normalized identifier of the DNS server response code. See <a target='_blank' href='https://datatracker.ietf.org/doc/html/rfc6895'>RFC-6895</a>.",
      "group": "primary",
      "requirement": "recommended",
      "enum": {
        "0": {
          "caption": "NoError",
          "description": "No Error."
        },
        "1": {
          "caption": "FormError",
          "description": "Format Error."
        },
        "2": {
          "caption": "ServError",
          "description": "Server Failure."
        },
        "3": {
          "caption": "NXDomain",
          "description": "Non-Existent Domain."
        },
        "4": {
          "caption": "NotImp",
          "description": "Not Implemented."
        },
        "5": {
          "caption": "Refused",
          "description": "Query Refused."
        },
        "6": {
          "caption": "YXDomain",
          "description": "Name Exists when it should not."
        },
        "7": {
          "caption": "YXRRSet",
          "description": "RR Set Exists when it should not."
        },
        "8": {
          "caption": "NXRRSet",
          "description": "RR Set that should exist does not."
        },
        "9": {
          "caption": "NotAuth",
          "description": "Not Authorized or Server Not Authoritative for zone."
        },
        "10": {
          "caption": "NotZone",
          "description": "Name not contained in zone."
        },
        "11": {
          "caption": "DSOTYPENI",
          "description": "DSO-TYPE Not Implemented."
        },
        "16": {
          "caption": "BADSIG_VERS",
          "description": "TSIG Signature Failure or Bad OPT Version."
        },
        "17": {
          "caption": "BADKEY",
          "description": "Key not recognized."
        },
        "18": {
          "caption": "BADTIME",
          "description": "Signature out of time window."
        },
        "19": {
          "caption": "BADMODE",
          "description": "Bad TKEY Mode."
        },
        "20": {
          "caption": "BADNAME",
          "description": "Duplicate key name."
        },
        "21": {
          "caption": "BADALG",
          "description": "Algorithm not supported."
        },
        "22": {
          "caption": "BADTRUNC",
          "description": "Bad Truncation."
        },
        "23": {
          "caption": "BADCOOKIE",
          "description": "Bad/missing Server Cookie."
        },
        "24": {
          "caption": "Unassigned",
          "description": "The codes deemed to be unassigned by the RFC (unassigned codes: 12-15, 24-3840, 4096-65534)."
        },
        "25": {
          "caption": "Reserved",
          "description": "The codes deemed to be reserved by the RFC (codes: 3841-4095, 65535)."
        },
        "99": {
          "caption": "Other",
          "description": "The dns response code is not defined by the RFC."
        }
      }
    },
    "src_endpoint": {
      "description": "The initiator (client) in a network connection.",
      "group": "primary",
      "requirement": "recommended",
      "object": "network endpoint",
      "constraints": {
        "at_least_one": [
          "domain",
          "hostname",
          "instance_uid",
          "interface_name",
          "interface_uid",
          "ip",
          "name",
          "svc_name",
          "uid"
        ]
      }
    },
    "traffic": {
      "description": "The network traffic refers to the amount of data moving across a network at a given point of time. Intended to be used alongside Network Connection.",
      "group": "primary",
      "requirement": "recommended",
      "object": "network traffic"
    },
    "type_uid": {
      "description": "The event/finding type ID. It identifies the event's semantics and structure. The value is calculated by the logging system as: class_uid * 100 + activity_id.",
      "requirement": "recommended",
      "enum": {
        "0": {
          "caption": "Unknown",
          "description": "Unknown"
        },
        "400300": {
          "caption": "Unknown",
          "description": "The activity type \"DNS Activity: Unknown\" is not further specified."
        },
        "400301": {
          "caption": "Query",
          "description": "The DNS query request."
        },
        "400302": {
          "caption": "Response",
          "description": "The DNS query response."
        },
        "400303": {
          "caption": "Traffic",
          "description": "Bidirectional DNS request and response traffic."
        },
        "400399": {
          "caption": "Other",
          "description": "The activity type \"DNS Activity: Other\" is not further specified."
        },
        "99": {
          "caption": "Other",
          "description": "Not mapped"
        }
      }
    }
  },
  "constraints": {
    "at_least_one": [
      "dst_endpoint",
      "src_endpoint"
    ]
  }
}
