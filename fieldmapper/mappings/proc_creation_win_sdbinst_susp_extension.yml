id: 18ee686c-38a3-4f65-9f44-48a077141f42
title: Uncommon Extension Shim Database Installation Via Sdbinst.EXE
status: test
level: medium
description: 'Detects installation of a potentially suspicious new shim with an uncommon
    extension using sdbinst.exe.

    Adversaries may establish persistence and/or elevate privileges by executing malicious
    content triggered by application shims

    '
author: Nasreddine Bencherchali (Nextron Systems)
date: '2023-08-01'
modified: '2024-01-10'
tags:
    - attack.persistence
    - attack.privilege-escalation
    - attack.t1546.011
references:
    - https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html
    - https://github.com/nasbench/Misc-Research/blob/8ee690e43a379cbce8c9d61107442c36bd9be3d3/Other/Undocumented-Flags-Sdbinst.md
falsepositives:
    - Unknown
related: 'SigmaRelated(related=[SigmaRelatedItem(id=UUID(''517490a7-115a-48c6-8862-1a481504d5a8''),
    type=<SigmaRelatedType.DERIVED: 2>)])'
taxonomy: sigma
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith: \sdbinst.exe
        OriginalFileName: sdbinst.exe
    filter_main_legit_ext:
        CommandLine|contains: .sdb
    filter_main_legit_extensions:
        CommandLine|endswith:
            - ' -c'
            - ' -f'
            - ' -mm'
            - ' -t'
        CommandLine|contains: ' -m -bg'
    filter_main_null:
        CommandLine: null
    filter_main_empty:
        CommandLine: ''
    condition: selection and not 1 of filter_main_*
ocsf_mapping:
    class_name: process_activity
    logsource:
        category:
            source_field: category
            source_value: process_creation
            mapped_at: '2025-11-13T20:20:28.724626+00:00'
        product:
            source_field: product
            source_value: windows
            mapped_at: '2025-11-13T20:20:28.724626+00:00'
    detection_fields:
        -   source_field: Image
            target_table: process_activity
            target_field: process.name
            mapped_at: '2025-11-13T20:20:28.724641+00:00'
        -   source_field: OriginalFileName
            target_table: process_activity
            target_field: process.file.name
            mapped_at: '2025-11-13T20:20:28.724644+00:00'
        -   source_field: CommandLine
            target_table: process_activity
            target_field: process.cmd_line
            mapped_at: '2025-11-13T20:20:28.724646+00:00'
