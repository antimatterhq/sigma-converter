title: Successful IIS Shortname Fuzzing Scan
id: 7cb02516-6d95-4ffc-8eee-162075e111ac
status: test
level: medium
author: frack113
description: When IIS uses an old .Net Framework it's possible to enumerate folders
    with the symbol "~"
references:
    - https://github.com/projectdiscovery/nuclei-templates/blob/9d2889356eebba661c8407038e430759dfd4ec31/fuzzing/iis-shortname.yaml
    - https://www.exploit-db.com/exploits/19525
    - https://github.com/lijiejie/IIS_shortname_Scanner
falsepositives:
    - Unknown
tags:
    - attack.initial-access
    - attack.t1190
date: '2021-10-06'
modified: '2023-01-02'
logsource:
    category: webserver
detection:
    selection:
        cs-uri-query|contains: ~1
        cs-uri-query|endswith: a.aspx
        cs-method:
            - GET
            - OPTIONS
        sc-status:
            - 200
            - 301
    condition: selection
ocsf_mapping:
    class_name: http_activity
    activity_id: <UNMAPPED>
    logsource:
        category:
            source_field: category
            source_value: webserver
            mapped_at: '2025-12-04T01:35:03.574236+00:00'
    detection_fields:
        -   source_field: cs-uri-query
            target_table: http_activity
            target_field: http_request.args
            mapped_at: '2025-12-04T01:35:03.574251+00:00'
        -   source_field: cs-method
            target_table: http_activity
            target_field: http_request.http_method
            mapped_at: '2025-12-04T01:35:03.574253+00:00'
        -   source_field: sc-status
            target_table: http_activity
            target_field: http_response.status
            mapped_at: '2025-12-04T01:35:03.574276+00:00'
