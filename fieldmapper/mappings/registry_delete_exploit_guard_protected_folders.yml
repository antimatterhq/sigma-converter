id: 272e55a4-9e6b-4211-acb6-78f51f0b1b40
title: Folder Removed From Exploit Guard ProtectedFolders List - Registry
status: test
level: high
description: Detects the removal of folders from the "ProtectedFolders" list of of
    exploit guard. This could indicate an attacker trying to launch an encryption
    process or trying to manipulate data inside of the protected folder
author: Nasreddine Bencherchali (Nextron Systems)
date: '2022-08-05'
modified: '2023-02-08'
tags:
    - attack.defense-evasion
    - attack.t1562.001
references:
    - https://www.microsoft.com/security/blog/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/
falsepositives:
    - Legitimate administrators removing applications (should always be investigated)
taxonomy: sigma
logsource:
    category: registry_delete
    product: windows
detection:
    selection:
        EventType: DeleteValue
        TargetObject|contains: SOFTWARE\Microsoft\Windows Defender\Windows Defender
            Exploit Guard\Controlled Folder Access\ProtectedFolders
    condition: selection
ocsf_mapping:
    class_name: null
    activity_id: null
    logsource:
        category:
            source_field: category
            source_value: registry_delete
            mapped_at: null
        product:
            source_field: product
            source_value: windows
            mapped_at: null
    detection_fields:
        -   source_field: EventType
            target_table: null
            target_field: null
            mapped_at: null
        -   source_field: TargetObject
            target_table: null
            target_field: null
            mapped_at: null
