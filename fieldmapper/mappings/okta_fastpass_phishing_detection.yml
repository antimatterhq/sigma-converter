title: Okta FastPass Phishing Detection
id: ee39a9f7-5a79-4b0a-9815-d36b3cf28d3e
status: test
level: high
author: Austin Songer @austinsonger
description: Detects when Okta FastPass prevents a known phishing site.
references:
    - https://sec.okta.com/fastpassphishingdetection
    - https://developer.okta.com/docs/reference/api/system-log/
    - https://developer.okta.com/docs/reference/api/event-types/
falsepositives:
    - Unlikely
tags:
    - attack.initial-access
    - attack.t1566
date: '2023-05-07'
logsource:
    product: okta
    service: okta
detection:
    selection:
        outcome.reason: FastPass declined phishing attempt
        outcome.result: FAILURE
        eventtype: user.authentication.auth_via_mfa
    condition: selection
ocsf_mapping:
    class_name: user_access
    activity_id: <UNMAPPED>
    logsource:
        product:
            source_field: product
            source_value: okta
            mapped_at: '2025-12-04T01:37:17.383964+00:00'
        service:
            source_field: service
            source_value: okta
            mapped_at: '2025-12-04T01:37:17.383964+00:00'
    detection_fields:
        -   source_field: outcome.reason
            target_table: user_access
            target_field: status_detail
            mapped_at: '2025-12-04T01:37:17.383977+00:00'
        -   source_field: outcome.result
            target_table: user_access
            target_field: actor.authorizations.decision
            mapped_at: '2025-12-04T01:37:17.383979+00:00'
        -   source_field: eventtype
            target_table: user_access
            target_field: action
            mapped_at: '2025-12-04T01:37:17.383981+00:00'
