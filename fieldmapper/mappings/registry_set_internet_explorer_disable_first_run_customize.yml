title: Internet Explorer DisableFirstRunCustomize Enabled
id: ab567429-1dfb-4674-b6d2-979fd2f9d125
status: test
level: medium
author: Nasreddine Bencherchali (Nextron Systems)
description: 'Detects changes to the Internet Explorer "DisableFirstRunCustomize"
    value, which prevents Internet Explorer from running the first run wizard the
    first time a user starts the browser after installing Internet Explorer or Windows.

    '
references:
    - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/devil-bait/NCSC-MAR-Devil-Bait.pdf
    - https://unit42.paloaltonetworks.com/operation-ke3chang-resurfaces-with-new-tidepool-malware/
    - https://admx.help/?Category=InternetExplorer&Policy=Microsoft.Policies.InternetExplorer::NoFirstRunCustomise
falsepositives:
    - As this is controlled by group policy as well as user settings. Some false positives
        may occur.
tags:
    - attack.defense-evasion
date: '2023-05-16'
modified: '2023-08-17'
logsource:
    category: registry_set
    product: windows
detection:
    selection:
        TargetObject|endswith: \Microsoft\Internet Explorer\Main\DisableFirstRunCustomize
        Details:
            - DWORD (0x00000001)
            - DWORD (0x00000002)
    filter_main_generic:
        Image:
            - C:\Windows\explorer.exe
            - C:\Windows\System32\ie4uinit.exe
    condition: selection and not 1 of filter_main_*
ocsf_mapping:
    class_name: null
    activity_id: null
    logsource:
        category:
            source_field: category
            source_value: registry_set
            mapped_at: null
        product:
            source_field: product
            source_value: windows
            mapped_at: null
    detection_fields:
        -   source_field: TargetObject
            target_table: null
            target_field: null
            mapped_at: null
        -   source_field: Details
            target_table: null
            target_field: null
            mapped_at: null
        -   source_field: Image
            target_table: null
            target_field: null
            mapped_at: null
